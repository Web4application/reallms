<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Script Analyzer </title>
  <style>
    body { font-family: sans-serif; background: #121212; color: #eee; padding: 2rem; }
    .container { max-width: 800px; margin: auto; }
    textarea { width: 100%; height: 200px; background: #1e1e1e; color: #fff; border: none; padding: 1rem; margin-top: 1rem; }
    button { margin-top: 1rem; padding: 0.6rem 1.2rem; background: #3b82f6; color: white; border: none; cursor: pointer; }
    button:hover { background: #2563eb; }
    input[type="file"] { margin-top: 1rem; }
    #output { white-space: pre-wrap; margin-top: 1.5rem; background: #1e1e1e; padding: 1rem; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üìú Script Analyzer </h1>
    <p>Upload your JavaScript file. The AI will generate a README.md for you.</p>

    <input type="file" id="fileInput" accept=".js" />
    <button onclick="uploadFile()">Analyze and Generate README</button>

    <div id="output"></div>
    <a id="downloadLink" href="#" style="display: none;" download>‚¨áÔ∏è Download README</a>
  </div>

  <script>
    async function uploadFile() {
      const fileInput = document.getElementById('fileInput');
      const output = document.getElementById('output');
      const downloadLink = document.getElementById('downloadLink');

      if (!fileInput.files.length) {
        alert("Please choose a file!");
        return;
      }

      const file = fileInput.files[0];
      const formData = new FormData();
      formData.append("file", file);

      output.textContent = "‚è≥ Uploading and analyzing...";

      const response = await fetch("http://localhost:8080/upload/generate-doc-file", {
        method: "POST",
        body: formData
      });

      const result = await response.json();

      if (result.download_url) {
        output.textContent = "‚úÖ README.md generated!";
        downloadLink.href = `http://localhost:8080${result.download_url}`;
        downloadLink.style.display = "inline-block";
      } else {
        output.textContent = "‚ùå Failed to generate README.";
      }
    }
  </script>
</body>
</html>
